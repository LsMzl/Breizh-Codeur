{% extends 'base.html.twig' %}

{% block title %}Profil Utilisateur{% endblock %}

{% block body %} 
    <h1 class="text-center">Votre profil</h1>  
    <img 
        class="profilePic text-center"
        src="/uploads/users/{{ app.user.picture }}" 
        alt="Photo de profil">
    <div class="mb-5"> 

        {# Formulaire d'affichage et de modification des données utilisateur #}
        <fieldset>
            <legend>
                <i class="bi bi-card-text"></i>
                Mes informations
            </legend>

            {{ include('user/components/_form_modif_user.html.twig', { form: form }, with_context = false) }}
        </fieldset>
    </div>


    {# Liste de tous les commentaires postés par l'utilisateur #}
    <div>
        <h3 class="border-bottom mb-4">Mes commentaires</h3>

        {% if comments|length >= 1 %}     
            {% for comment in comments %}
                {# Si l'id de l'auteur du commentaire correspond à l'id de l'utilisateur #}
                {% if comment.getAuthor.id == app.user.getId %} 
                    <div>
                        <a href="{{path('show', {id: comment.getPost.id})}}" class="fw-bold fs-5">{{ comment.getPost.title }}</a>
                        <p class="font-italic">{{ comment.publishedAt | date ('d.m.Y') }}</p>
                        <p>{{ comment.content }}</p>
                        <hr>
                    </div>
                {% endif %} 
            {% endfor %} 
            {# Si l'id de l'utilisateur ne correspond à aucun id d'auteur de commentaires #}
        {% else %}
            <p class="text-info">Vous n'avez publié aucun commentaire pour le moment.</p>
        {% endif %}  
    </div>


    {# Liste de tous les articles postés par l'utilisateur #}
    <div>
        <h3 class="border-bottom mb-4">Mes articles</h3>

        {% if posts|length >= 1 %} 
            {% for post in posts %}
            {# Si l'id de l'auteur de l'article correspond à l'id de l'utilisateur #}
                {% if post.getAuthor.id == app.user.getId %} 
                    <div>
                    {% for tags in post.getTags %}
                        <p class="text-info"># {{ tags.name }}</p>
                    {% endfor %} 
                        <a href="{{path('show', {id: post.id})}}">{{ post.title }}</a>
                        <p>{{ post.publishedAt | date ('d.m.Y') }}</p>
                        <hr>
                    </div>
                {% endif %} 
            {% endfor %} 
            {# Si l'id de l'utilisateur ne correspond à aucun id d'auteur d'article #}
        {% else %}
            <p class="text-info">Vous n'avez publié aucun article pour le moment.</p>
        {% endif %} 
    </div>

{% endblock %}